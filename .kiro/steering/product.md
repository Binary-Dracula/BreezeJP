---
inclusion: always
---

# BreezeJP MVP 产品需求文档

## 产品概述

BreezeJP 是一款追求极致"心流"体验的日语单词记忆 App。采用全屏沉浸式交互（类似 TikTok）和关联语义探索（类似维基百科漫游），解决背单词枯燥和"孤岛记忆"的问题。

### 核心价值

- **沉浸感**：去 UI 化，全屏展示
- **清晰交互**：左右滑动切换单词，上下滑动查看详情，彻底解决手势冲突
- **关联性**：学完"狗"推荐"猫"，建立语义网络
- **掌控感**：通过分支选择避免难度失控，用户决定学习路径
- **自由度**：无每日新词上限，用户可无限探索
- **科学性**：底层支持 SM-2 与 FSRS 双算法引擎

## 应用架构

舍弃底部导航栏，采用单页 Dashboard 结构，所有功能入口汇聚于首页。

### 学习路径

1. 首页点击"开始学习"
2. **复习阶段**（如有到期单词）：优先进入极简复习模式，清理 SRS 队列
3. **无尽探索阶段**（复习完成后/无复习时）：
   - 无缝进入语义分支模式
   - 学完一个词 → 选择下一个关联词 → 学完 → 选择...
   - 用户随时通过手势（右滑返回）结束 Session

## 功能模块

### 首页 (Dashboard)

布局：Bento Grid 网格仪表盘，垂直滚动

| 组件 | 功能 | 数据逻辑 |
|------|------|----------|
| Header | 问候语、用户名、设置入口 | 读取本地配置 |
| Hero Card | 状态 A：显示待复习数，"清理今日记忆债务"<br>状态 B：显示"开始探索"，"发现新的日语世界" | 查询 `study_words` 表中 `next_review_at <= now` 的数量 |
| Stats Row | 连续打卡天数、已掌握词数、今日已学数 | 读取 `daily_stats` 表 |
| Tools Grid | 2x2 网格：单词本、详细统计、(预留位) | 路由跳转 |

### 学习流容器

技术实现：`PageView` (scrollDirection: Axis.vertical) 全屏翻页

支持三种页面类型：
- **WordPage (Review)**：复习页（极简版）
- **WordPage (Learn)**：学习页（全展示）
- **ChoicePage**：分支选择页（路由节点）

### 复习模式 (Review Mode)

场景：处理旧单词 (`user_state = 1`)，目标是无脑、快速

**阶段一：提问**
- 屏幕中央仅显示单词大字
- 下方灰色小字"点击查看释义"
- 点击屏幕任意区域进入阶段二

**阶段二：回答**
- 展开显示假名、释义、例句
- 自动播放单词发音
- 底部 3 个评分按钮：
  - ❌ 忘了 → Rating 1 (Again)
  - ⭕ 记得 → Rating 3 (Good)
  - ⚡ 秒杀 → Rating 4 (Easy)
- 点击按钮 → 算法更新 → 自动滑入下一页

**防误触**：阶段一未看答案时，禁止手动滑到下一页

### 语义分支学习模式 (Associative Learn Mode)

场景：学习新单词 (`user_state = 0`)，无尽模式

**单词学习页**
- 全屏展示单词、假名、释义、例句
- 自动播放音频
- 底部提示"上滑继续"
- 页面展示时标记为"学习中"，写入 `study_logs`

**路径选择页 (Choice Page)**
- 文案："学完了「狗」，接下来你想探索什么？"
- 动态生成选项列表：
  - 选项 A：猫 (关联: 强 | 难度: N5 🟢)
  - 选项 B：动物 (关联: 中 | 难度: N5 🟢)
  - 选项 C：脊索动物 (关联: 弱 | 难度: N1 🔴)
- 兜底选项："随机推荐一个"
- 点击选项 → 加入 PageView 队列 → 滑入学习页

**退出**：点击左上角"关闭"或右滑返回，结算本次学习时长和数量

## 算法逻辑

### 推荐算法

生成路径选择页时执行：

```sql
SELECT w.*, wa.weight 
FROM word_associations wa
JOIN words w ON wa.target_word_id = w.id
WHERE wa.source_word_id = [CurrentWordID]
  AND w.id NOT IN (SELECT word_id FROM study_words WHERE user_state > 0)
ORDER BY wa.weight DESC
LIMIT 3;
```

UI 层根据 `jlpt_level` 渲染难度标签（N5=绿, N1=红）

### 记忆算法

- 默认使用 SM-2
- 预留 FSRS 接口，Pro 设置开启后读写 `stability` 和 `difficulty` 字段

## UI/UX 规范

- **手势**：全屏垂直滑动
- **震动反馈**：页面切换时触发 `HapticFeedback.lightImpact()`
- **防误触**：复习模式下未评分前锁定向下滑动
- **进度反馈**：右上角显示本次 Session 计数器（本次已学 +5）

## MVP 范围外

暂不开发：
- 用户注册/登录/云同步（使用本地 SQLite）
- 自定义生词本/词单创建
- 听写模式/拼写模式
- 社交功能
- 每日新词上限设置
