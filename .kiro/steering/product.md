---
inclusion: always
---

# BreezeJP MVP 产品需求文档

## 产品概述

BreezeJP 是一款追求极致"心流"体验的日语单词记忆 App。采用全屏沉浸式交互（类似 TikTok）和关联语义探索（类似维基百科漫游），解决背单词枯燥和"孤岛记忆"的问题。

### 核心价值

- **沉浸感**：去 UI 化，全屏展示
- **清晰交互**：左右滑动切换单词，上下滑动查看详情，彻底解决手势冲突
- **关联性**：学完"狗"推荐"猫"，建立语义网络
- **掌控感**：通过分支选择避免难度失控，用户决定学习路径
- **自由度**：无每日新词上限，用户可无限探索
- **科学性**：底层支持 SM-2 与 FSRS 双算法引擎

## 应用架构

舍弃底部导航栏，采用单页 Dashboard 结构，所有功能入口汇聚于首页。

## 功能模块

# 首页（Dashboard）

首页是 BreezeJP 的学习控制中心。所有核心学习入口（单词学习、五十音学习、复习模式）均集中于首页，并以极简、轻负担的方式呈现。首页采用卡片式布局，可垂直滚动，由以下模块组成：

1. Header（顶部区域）
2. Primary Actions（学习主入口）
3. Review Section（复习模块）
4. Stats Card（学习统计）
5. Tools Grid（工具区）

首页需要同时兼顾两类用户情境：

- 新用户：没有任何单词与五十音学习记录
- 已学习用户：拥有单词与/或五十音学习进度

模块展示需要根据用户状态智能调整。

---

## 1. Header（顶部区域）

展示内容：

- 问候语（根据时间段自动切换）
- 用户昵称（来自 users 表）
- 设置按钮

新用户：

- 可显示“欢迎开始你的日语之旅”类文案
- 没有学习记录也不会出现空白区域

已有学习记录用户：

- 正常显示问候语与昵称

Header 不依赖任何学习数据，无需区分处理，整体风格保持轻量与友好。

---

## 2. Primary Actions（学习主入口）

此区域用于承载学习行为的主入口，始终出现在首页的顶部区域下方。包含两个入口：

- 学习新单词（Learn New Words）
- 学习五十音图（Learn Kana）

### 学习新单词（Learn New Words）

功能：
进入 BreezeJP 的语义分支学习模式，以关联词语构建学习链条。
不显示固定学习进度，保持心流式学习（无任务、无章节、无进度条）
此入口始终可用，不会因复习任务未完成而禁用。

### 学习五十音图（Learn Kana）

功能：
进入五十音学习页，包括笔顺、读音、描红等内容。
不需要显示“已学 XX 个假名”等进度，保持模块简洁
用户自由选择从任意假名继续学习（五十音为固定集合，无需进度提示）
该入口始终可用，与单词学习入口同级。

---

## 3. Review Section（复习模块）

复习是 BreezeJP SRS 学习体系的核心功能。
本模块包含两个并列入口：

- 复习单词（Review Words）
- 复习五十音图（Review Kana）

### 复习单词（Review Words）

数据逻辑：
统计 study_words 表中满足以下条件的数量：

- user_id = 当前用户
- next_review_at <= now

新用户：

- 无复习数据，显示：“还没有需要复习的单词”
- 显示“0 个待复习”，入口仍可点击（引导至学习新单词）

已有学习记录用户：

- 若有待复习：显示“今日待复习：X 个单词”
- 若已清空复习：显示“今日已复习完成”或“0 个待复习”

### 复习五十音图（Review Kana）

数据逻辑：
统计 kana_learning_state 表中满足：

- user_id = 当前用户
- learning_status = 学习中
- next_review_at <= now

新用户：

- 无需复习，显示：“还没有需要复习的假名”
- 显示“0 个待复习”，点击后引导用户去学习五十音

已有学习记录用户：

- 若有待复习：显示“今日待复习：X 个假名”
- 若无待复习：显示“今日假名复习已完成”

### 复习模块设计原则

- 复习入口永不隐藏（即使数量为 0）
- 复习不压制学习：用户可自由选择先学新内容再复习
- 单词与五十音拥有独立 SRS 队列，各自独立展示

---

## 4. Stats Card（学习统计）

以卡片形式展示用户的关键学习指标：

- 今日已学习单词数
- 今日已复习单词数
- 累计掌握单词数
- 连续学习天数
- 今日学习时长

数据来源：
daily_stats 表（按天聚合的学习统计数据）

新用户：

- 所有数值为 0
- 文案显示为引导样式，例如：

  - “今天还没有开始学习，试着学一个新单词吧”
  - “连续学习天数将在你开始学习后记录”

已有学习记录用户：

- 正常显示具体数值
- 若某项为 0，不需要特殊处理

此模块增强用户的持续学习动机，并提供成就感反馈。

---

## 5. Tools Grid（工具区）

用于展示低频但重要的工具性页面入口，例如：

- 单词本
- 详细统计
- 预留扩展功能入口

此区域对新用户与老用户完全一致。

工具区不参与学习主流程，仅提供功能性辅助。

---

# 首页设计原则（更新版）

1. 学习入口优先：Primary Actions 是首页顶部主入口，突出“主动学习”而非“任务”。
2. 复习模块独立：复习内容与学习入口分区，用户可自由掌控每日学习节奏。
3. 五十音模块独立：五十音的学习与复习与单词体系并行，不交叉混淆。
4. 空状态友好：新用户不会看到生硬的“0 条数据”，而是温和的引导文案。
5. 成就与反馈及时：Stats Card 提供每日与长期行为反馈，增强动力。
6. 不追踪学习进度：保持心流体验，不显示队列式“继续学习”模块，也不记录学习位置。
7. 可扩展性高：Tools Grid 预留未来模块，不影响主学习体验。

此版本首页设计兼顾了新用户与已有学习记录用户的体验，并强化了 BreezeJP 的核心理念：
“简单开始、轻松学习、无需压力、保持心流”。

---

### 记忆算法

- 默认使用 SM-2
- 预留 FSRS 接口，Pro 设置开启后读写 `stability` 和 `difficulty` 字段

## UI/UX 规范

- **手势**：学习模式左右滑动切换单词
- **震动反馈**：页面切换时触发 `HapticFeedback.lightImpact()`
- **进度反馈**：右上角显示本次 Session 计数器（本次已学 +5）
- **国际化**：所有用户可见文本必须使用 `AppLocalizations`，禁止硬编码字符串

# BreezeJP 五十音复习题型选择系统（全局架构）

BreezeJP 的五十音复习采用多题型、多模态机制；每次复习时根据假名的学习状态与历史表现选择最合适的题型，而非单一形式。题型选择由「Kana Review Item-Type Selector」决定。

当前 MVP 支持：

1. 读音回忆（Recall Reading）：回忆假名读音
2. 听音辨假名（Audio Recognition）：听音后选择正确假名
3. 平假名 ↔ 片假名对照（Kana Switch）：平/片假名互选

---

## 1. 系统目标

- 多维巩固：听觉/视觉/回忆并用
- 降低枯燥：避免单一题型
- SRS 兼容：评分仍用 Again / Good / Easy
- 轻量 MVP：不新增表结构，逻辑尽量简单

---

## 2. 题型选择引擎（Selector）

**Step 1：读取熟练度（kana_learning_state）**

- 弱项（Weak）：fail_count ≥ 3
- 初级（New）：streak ≤ 1
- 熟练（Strong）：streak ≥ 2  
  （使用现有字段，无需新增）

**Step 2：按熟练度给题型优先级**

| 熟练度 | 优先 1       | 优先 2     | 优先 3     |
| ------ | ------------ | ---------- | ---------- |
| 弱项   | 听音辨假名   | 平片对照   | 读音回忆   |
| 初级   | 罗马音选择题 | 听音辨假名 | —          |
| 熟练   | 读音回忆     | 平片对照   | 听音辨假名 |

**Step 3：避免短期重复**  
读取 kana_logs 最近一次的题型，如果与当前优先题型相同，则切换到下一个优先级，保持新鲜感。

**Step 4：确定题型**  
按优先级 → 去重 → 得到最终题型。  
例：假名「あ」为弱项且上次是“听音”，则当前切换为“平片对照”。

---

## 3. 与 SRS 的关系

- 题型决定“怎么提问”，SRS 评分决定“何时再复习”。
- 无论题型为何，评分沿用 Again/Good/Easy 来计算 next_review_at。

---

## 4. 架构优势

- 记忆效果：听觉+视觉+回忆，多模态更牢固。
- 体验友好：复习不单调，提升意愿。
- 实现轻量：沿用现有字段和日志，无需改库。

不修改数据库，不需要训练模型，也不需要复杂统计。

### 4）可扩展性强

未来可加入更多题型（笔顺题、草写识别、混淆假名强化等），无需改变现有架构。

---

## 5. 当前实现阶段（MVP）

题型选择范围：

- 读音回忆
- 听音辨假名
- 平假名 ↔ 片假名对照

题型选择规则：基于 streak、fail_count、最近一次题型避免规则。

未来可扩展为 PRO 版本（Adaptive Learning Engine）。

### 设计原则

- 模式可独立进入，互不阻塞；复习入口保持开放。
- SRS 仅绑定读音回忆模式，其它模式可作为加分练习或无评分练习。
- 在 Dashboard/复习入口清晰展示模式选择，避免用户以为只有一种复习方式。
- 逐步解锁：MVP 先交付 1~3，后续按优先级上线 4~6。
