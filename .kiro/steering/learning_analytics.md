---
inclusion: always
---

# Learning Analytics Rules

> **Status: Frozen**
>
> æœ¬æ–‡æ¡£å®šä¹‰ BreezeJP ä¸­æ‰€æœ‰ã€Œå­¦ä¹ ç»Ÿè®¡ / è¿›åº¦ç»Ÿè®¡ / Dashboard æ•°å€¼ã€çš„
> **å”¯ä¸€åˆæ³•è¯­ä¹‰ä¸Žå£å¾„**ã€‚
>
> **ä»»ä½•è¿åæœ¬æ–‡æ¡£çš„ç»Ÿè®¡ç»“æžœï¼Œå‡è§†ä¸ºé€»è¾‘ Bugï¼Œ
> è€Œéž UI æˆ–å±•ç¤ºé—®é¢˜ã€‚**

---

## 1. Scopeï¼ˆé€‚ç”¨èŒƒå›´ï¼‰

æœ¬è§„åˆ™é€‚ç”¨äºŽï¼š

* å‡åï¼ˆKanaï¼‰å­¦ä¹ 
* å•è¯ï¼ˆWordï¼‰å­¦ä¹ 
* Dashboard / Home é¡µé¢ç»Ÿè®¡
* æˆå°±ç³»ç»Ÿï¼ˆè‹¥æœ‰ï¼‰
* å‘¨æŠ¥ / æœˆæŠ¥ / å­¦ä¹ æ€»ç»“ï¼ˆè‹¥æœ‰ï¼‰

ä¸é€‚ç”¨äºŽï¼š

* UI å±•ç¤ºæ ·å¼
* æ•°æ®åº“å­˜å‚¨ç»“æž„
* SRS ç®—æ³•å†…éƒ¨å‚æ•°

---

## 2. æ•°æ®æ¨¡åž‹è§’è‰²å£°æ˜Žï¼ˆå…³é”®ï¼‰

åœ¨ BreezeJP ä¸­ï¼Œ**å­¦ä¹ ç»Ÿè®¡å¿…é¡»ä¸¥æ ¼åŒºåˆ†ä¸‰ç±»æ•°æ®è§’è‰²**ï¼š

| æ•°æ®æº           | ç±»åž‹          | è§’è‰²      |
| ------------- | ----------- | ------- |
| `study_words` | State-based | å½“å‰çŠ¶æ€    |
| `study_logs`  | Event-based | ç”¨æˆ·è¡Œä¸ºäº‹ä»¶  |
| `daily_stats` | Analytics   | å·²ç¡®è®¤ç»Ÿè®¡ç»“æžœ |

> â— ä»»ä½•ç»Ÿè®¡å£å¾„ **åªèƒ½æ¥è‡ªä¸€ä¸ªè§’è‰²**
> âŒ ä¸¥ç¦ state ä¸Ž event æ··ç”¨ã€äº’ç›¸æŽ¨å¯¼

---

## 3. Learning Status Definitionsï¼ˆå­¦ä¹ çŠ¶æ€å®šä¹‰ï¼‰

ä»¥ä¸‹çŠ¶æ€**ä»…ç”¨äºŽæè¿°å½“å‰çŠ¶æ€ï¼Œä¸ç›´æŽ¥å‚ä¸Žç»Ÿè®¡è®¡ç®—**ï¼š

| Status     | Description           |
| ---------- | --------------------- |
| `seen`     | å·²æ›å…‰ã€‚å†…å®¹è¢«å±•ç¤ºï¼Œä½†ç”¨æˆ·å°šæœªåšå‡ºå­¦ä¹ æ‰¿è¯º |
| `learning` | å­¦ä¹ ä¸­ã€‚å½“å‰å‚ä¸Ž SRS          |
| `mastered` | å·²æŽŒæ¡ã€‚å­¦ä¹ ç”Ÿå‘½å‘¨æœŸå®Œæˆ          |
| `ignored`  | å·²å¿½ç•¥ã€‚ç”¨æˆ·æ˜Žç¡®é€‰æ‹©ä¸å­¦ä¹          |

### é‡è¦è¯´æ˜Ž

* `seen` **ä¸æ˜¯å­¦ä¹ è¡Œä¸º**
* `learning` **ä¸æ˜¯å­¦ä¹ äº‹ä»¶**
* `mastered` **ä¸æ˜¯æ–°å­¦**
* `ignored` **ä¸æ˜¯å­¦ä¹ æˆæžœ**
* çŠ¶æ€å˜åŒ– â‰  ç”¨æˆ·è¡Œä¸º

---

## 4. FirstLearnï¼ˆé¦–æ¬¡å­¦ä¹ äº‹ä»¶ï¼‰ã€æ ¸å¿ƒä¿®è®¢ã€‘

### å®šä¹‰ï¼ˆå†»ç»“ï¼‰
- firstLearn è¡¨ç¤ºç”¨æˆ·ç¬¬ä¸€æ¬¡ç‚¹å‡»ã€ŒåŠ å…¥å¤ä¹ ã€
- ä¸Ž study_words çŠ¶æ€æ— å…³
- æ¯ä¸ª (user, word) æœ€å¤šä¸€æ¬¡
- æ˜¯å¦è®¡å…¥â€œä»Šæ—¥å­¦ä¹ â€ï¼Œä»…å–å†³äºŽ firstLearn.created_at æ˜¯å¦åœ¨ä»Šæ—¥
- mastered / ignored / restore å‡ä¸ä¼šäº§ç”Ÿ firstLearn

### æ•°æ®æ¥æº

```text
study_logs.log_type = firstLearn
```

### ä¸¥æ ¼è§„åˆ™

* æ¯ä¸ª `(user_id, content_id)` **æœ€å¤šåªèƒ½æœ‰ä¸€æ¡** firstLearn
* firstLearn **åªç”±ç”¨æˆ·æ˜¾å¼è¡Œä¸ºè§¦å‘**
* firstLearn **ä¸Ž learning_status æ— å…³**

### æ˜Žç¡®ç¦æ­¢

* âŒ æ ¹æ® `seen â†’ learning` æŽ¨å¯¼ firstLearn
* âŒ æ ¹æ® `study_words` æ˜¯å¦å­˜åœ¨æ¥æŽ¨å¯¼ firstLearn
* âŒ å› â€œæ–¹ä¾¿â€åœ¨çŠ¶æ€æ›´æ–°æ—¶é¡ºæ‰‹å†™ firstLearn

---

## 5. ä»Šæ—¥å­¦ä¹ ï¼ˆNew Learned Countï¼‰

### å®šä¹‰ï¼ˆå†»ç»“ï¼‰

> **ä»Šæ—¥å­¦ä¹  = ä»Šæ—¥äº§ç”Ÿçš„ firstLearn äº‹ä»¶æ•°é‡**

### åˆæ³•ç»Ÿè®¡å£å¾„

```text
COUNT(study_logs)
WHERE log_type = firstLearn
  AND created_at = today
```

### é‡è¦å£°æ˜Ž

* âŒ ä¸ä½¿ç”¨ `learning_status`
* âŒ ä¸ä½¿ç”¨ `study_words`
* âŒ ä¸å›žæ”¾ logs é‡æ–°è®¡ç®—
* âœ… firstLearn å†™å…¥æ—¶åŒæ­¥æ›´æ–° `daily_stats.new_learned_count`

---

## 6. Learned Countï¼ˆå½“å‰å­¦ä¹ ä¸­æ•°é‡ï¼‰

### å®šä¹‰

> **å½“å‰å­¦ä¹ ä¸­å†…å®¹æ•°é‡ï¼ˆçŠ¶æ€æŒ‡æ ‡ï¼‰**

### ç»Ÿè®¡å£å¾„

```text
learning_status = learning
```

### è¯´æ˜Ž

* è¿™æ˜¯ **çŠ¶æ€ç»Ÿè®¡**
* ä¸ç­‰åŒäºŽæ–°å­¦
* ä¸ç”¨äºŽâ€œä»Šæ—¥å­¦ä¹ â€

---

## 7. Mastered Countï¼ˆå·²æŽŒæ¡æ•°é‡ï¼‰

### å®šä¹‰

> **å·²å®Œæˆå­¦ä¹ ç”Ÿå‘½å‘¨æœŸçš„å†…å®¹æ•°é‡**

### ç»Ÿè®¡å£å¾„

```text
learning_status = mastered
```

### è¯´æ˜Ž

* `mastered` æ˜¯å­¦ä¹ ç”Ÿå‘½å‘¨æœŸçš„**ç»ˆæ€**
* ä¸å†å‚ä¸Ž SRS
* ä¸ä»£è¡¨â€œä»Šæ—¥å­¦ä¹ â€

---

## 8. Ignored Countï¼ˆå¿½ç•¥æ•°é‡ï¼‰ã€è¾…åŠ©æŒ‡æ ‡ã€‘

### å®šä¹‰

> ç”¨æˆ·æ˜Žç¡®é€‰æ‹©ä¸å­¦ä¹ çš„å†…å®¹æ•°é‡

### ç»Ÿè®¡å£å¾„

```text
learning_status = ignored
```

### ä½¿ç”¨é™åˆ¶

* âŒ ä¸è®¡å…¥ä»»ä½•å­¦ä¹ æˆæžœæŒ‡æ ‡
* âŒ ä¸å‚ä¸Žå®ŒæˆçŽ‡ / å­¦ä¹ çŽ‡è®¡ç®—
* âœ… ä»…ç”¨äºŽï¼š

  * æŽ¨èç³»ç»Ÿ
  * å†…å®¹è¿‡æ»¤
  * ç”¨æˆ·è¡Œä¸ºåˆ†æž

---

## 9. Completion Rateï¼ˆå®ŒæˆçŽ‡ï¼‰

### å®šä¹‰

> **å®ŒæˆçŽ‡ = å·²å®Œæˆå­¦ä¹  / æ›¾è¿›å…¥å­¦ä¹ çš„å†…å®¹**

### åˆæ³•è®¡ç®—å…¬å¼

```text
completion_rate = mastered / (learning + mastered)
```

### æ˜Žç¡®ç¦æ­¢

* âŒ å°† `seen` è®¡å…¥åˆ†æ¯
* âŒ å°† `ignored` è®¡å…¥åˆ†æ¯
* âŒ ä½¿ç”¨â€œå†…å®¹æ€»æ•°â€ä½œä¸ºåˆ†æ¯

---

## 10. SRS Participation Rulesï¼ˆSRS å‚ä¸Žè§„åˆ™ï¼‰

| Status     | æ˜¯å¦è¿›å…¥ SRS |
| ---------- | -------- |
| `seen`     | âŒ        |
| `learning` | âœ…        |
| `mastered` | âŒ        |
| `ignored`  | âŒ        |

> SRS **åªå¯¹ learning çŠ¶æ€è´Ÿè´£**
> ä»»ä½•å…¶å®ƒçŠ¶æ€è¿›å…¥ SRS éƒ½å±žäºŽä¸¥é‡é€»è¾‘é”™è¯¯

---

## 11. Prohibitionsï¼ˆæ˜Žç¡®ç¦æ­¢äº‹é¡¹ï¼‰

ä»¥ä¸‹è¡Œä¸º**è¢«æ˜Žç¡®ç¦æ­¢**ï¼š

* å°† `seen` è®¡å…¥ä»»ä½•å­¦ä¹ æˆæžœ
* å°† `learning` å½“ä½œæ–°å­¦
* å°† `mastered` å½“ä½œæ–°å­¦
* ç”¨çŠ¶æ€å˜åŒ–æ›¿ä»£ç”¨æˆ·è¡Œä¸º
* åœ¨ Query / Analytics ä¸­é‡æ–°è§£é‡Šç»Ÿè®¡å£å¾„
* ä¸ºâ€œè®©æ•°å­—å¥½çœ‹â€è€Œè°ƒæ•´å®šä¹‰

---

## 12. Change Policyï¼ˆå˜æ›´ç­–ç•¥ï¼‰

* æœ¬æ–‡ä»¶ä¸º **Freeze æ–‡æ¡£**

* ä»»ä½•ä¿®æ”¹å¿…é¡»åŒæ—¶æ›´æ–°ï¼š

  * æœ¬æ–‡æ¡£
  * Analytics å®žçŽ°
  * Dashboard æ–‡æ¡ˆï¼ˆå¦‚æœ‰ï¼‰

* âŒ ç¦æ­¢ï¼š

  * ç§è‡ªæ”¹ SQL
  * ä»…åœ¨ UI å±‚â€œä¿®æ­£è§£é‡Šâ€

---

## 13. Final Statementï¼ˆæœ€ç»ˆå†»ç»“å£°æ˜Žï¼‰

> **study_words æè¿°â€œçŽ°åœ¨æ˜¯ä»€ä¹ˆçŠ¶æ€â€
> study_logs æè¿°â€œç”¨æˆ·åšè¿‡ä»€ä¹ˆâ€
> daily_stats æè¿°â€œå·²ç»ç¡®è®¤çš„ç»Ÿè®¡ç»“æžœâ€**

> **ä»»ä½•æ··ç”¨ä¸‰è€…è¯­ä¹‰çš„å®žçŽ°ï¼Œ
> éƒ½æ˜¯æž¶æž„çº§é”™è¯¯ï¼Œè€Œä¸æ˜¯å®žçŽ°ç»†èŠ‚é—®é¢˜ã€‚**

---

### ðŸ”’ æœ€åŽä¸€æ¡ï¼ˆå¼ºçƒˆå»ºè®®åŽŸæ ·ä¿ç•™ï¼‰

> **When analytics data feels wrong,
> check this document first.
> If analytics violates this document, it is a bug.**

---